/* empty css                  */import{u as e,w as a}from"./xlsx-Dc3VwIYI.js";import{Z as n,a as u,p as m,q as l,t as r,U as d,O as t,a8 as s,T as o,F as g,a7 as c,S as i,ax as p,ay as v}from"./vue-CAdAVGuS.js";import{_ as h}from"./index-BvmzhVvH.js";import{E as f,a as x,b as V}from"./element-plus-CGdPHNE3.js";const k=[{num:1,name:"马佐涵",grade:0},{num:2,name:"张潇予",grade:0},{num:3,name:"杨子睿",grade:0},{num:4,name:"丁玺腾",grade:0},{num:5,name:"翟雅荣",grade:0},{num:6,name:"王梦佳",grade:0},{num:7,name:"王子阳",grade:0},{num:8,name:"刘博凌",grade:0},{num:9,name:"丁宜冰",grade:0},{num:10,name:"张星辰",grade:0},{num:11,name:"薛奕洋",grade:0},{num:12,name:"张灵桥",grade:0},{num:13,name:"孟令瑶",grade:0},{num:14,name:"韩瑜章",grade:0},{num:15,name:"赵轩毅",grade:0},{num:16,name:"王峥",grade:0},{num:17,name:"贾济玮",grade:0},{num:18,name:"赵泽寰",grade:0},{num:19,name:"李芷漩",grade:0},{num:20,name:"谢易娜",grade:0},{num:21,name:"张智博",grade:0},{num:22,name:"刘舜华",grade:0},{num:23,name:"马翔",grade:0},{num:24,name:"曹华亭",grade:0},{num:25,name:"陈姝贝",grade:0},{num:26,name:"李婧璇",grade:0},{num:27,name:"王军",grade:0},{num:28,name:"常雨馨",grade:0},{num:29,name:"杜晨曦",grade:0},{num:30,name:"郝欣雨",grade:0},{num:31,name:"周兴",grade:0},{num:32,name:"燕禛",grade:0},{num:33,name:"李卿",grade:0},{num:34,name:"何易",grade:0},{num:35,name:"王子涵",grade:0},{num:36,name:"宋忻豫",grade:0},{num:37,name:"田谨赫",grade:0},{num:38,name:"吉星霖",grade:0},{num:39,name:"张洪睿",grade:0},{num:40,name:"薛星戈",grade:0},{num:41,name:"索嘉澳",grade:0},{num:42,name:"姚思明",grade:0},{num:43,name:"张馨月",grade:0},{num:44,name:"王紫涵",grade:0},{num:45,name:"魏兆骏",grade:0},{num:46,name:"屈睿东",grade:0},{num:47,name:"韩林荣轩",grade:0},{num:48,name:"李昱萱",grade:0},{num:49,name:"李俊霖",grade:0},{num:50,name:"昝瑛畦",grade:0},{num:51,name:"武韵涵",grade:0},{num:52,name:"杨祺",grade:0},{num:53,name:"么雨忱",grade:0},{num:54,name:"林轩",grade:0},{num:55,name:"尹婧琦",grade:0},{num:56,name:"段旻岑",grade:0},{num:57,name:"王欣竹",grade:0},{num:58,name:"段京辰",grade:0},{num:59,name:"王荣美",grade:0},{num:60,name:"张楷浩",grade:0},{num:61,name:"荣鑫宇",grade:0},{num:62,name:"杨紫煜",grade:0},{num:63,name:"王星程",grade:0}],w={setup(){const m=n(k),l=u(0),r=u(""),d=u(""),t=u(""),s=u(m.map((e=>e.name))),o=u(m.map((e=>e.num))),g=u(m.map((e=>e.grade))),c=u([]),i=u(!1);function p(e){let a=[];if(0==!i.value)for(let n=0;n<e.length;n+=7){const u=Math.min(n+7,e.length),m=e.slice(n,u).filter((e=>null!=e&&0!==e)),l=m.reduce(((e,a)=>e+a),0)/m.length;a.push(l)}else for(let n=0;n<e.length;n+=7){const u=Math.min(n+7,e.length),m=e.slice(n,u),l=m.reduce(((e,a)=>e+parseInt(a,10)),0)/m.length;a.push(l)}c.value=a}function v(){g.value.forEach(((e,a)=>{m[a].grade=e})),function(n){const u=[];let m=1,l=0;n.forEach(((e,a)=>{u.push(e),(a+1)%7==0&&u.push({num:"均分",name:`第${m++}组`,grade:`平均分${c.value[l++]}`})})),function(n){const u=e.json_to_sheet(n),m=e.book_new();e.book_append_sheet(m,u,"Data"),a(m,"result.xlsx")}(u)}(m)}return{downValue:function(){r.value--},upValue:function(){r.value++},isFullPerson:i,RawGrades:g,nums:o,names:s,ArrNum:r,ArrName:d,grades:t,ArrIndex:l,avgEverySeven:c,fetchArrNum:function(){r.value>=0&&r.value<=m.length?(l.value=r.value-1,d.value=m[l.value].name):alert("学号输入有误")},handleInput:function(){t.value>=0&&t.value?(g.value[l.value]=t.value,t.value="",r.value="",d.value="",p(g.value)):alert("成绩或学号输入有误")},handleInputToExpert:function(){t.value="",r.value="",d.value="",p(g.value),v()},CheckToCalculateGroupAverages:function(){setTimeout((()=>{p(g.value)}),300)},exportResult:v}}},y=e=>(p("data-v-b0776dd0"),e=e(),v(),e),A=y((()=>r("h1",{class:"title"},null,-1))),C=y((()=>r("h1",{class:"tlt"},"登分器",-1))),I={class:"input-box"},_={class:"container"},b={class:"row"},N={class:"column"},E={class:"column"},j={class:"column"},T={class:"column"};const F=h(w,[["render",function(e,a,n,u,p,v){const h=f,k=x,w=V;return m(),l(g,null,[A,C,r("main",null,[d(h,{onClick:u.handleInput},{default:t((()=>[i("Next")])),_:1},8,["onClick"]),d(k,{modelValue:u.isFullPerson,"onUpdate:modelValue":a[0]||(a[0]=e=>u.isFullPerson=e),onClick:u.CheckToCalculateGroupAverages,label:"是否去除未考式人员"},null,8,["modelValue","onClick"]),d(w,{required:"",min:"0",max:"63",modelValue:u.ArrNum,"onUpdate:modelValue":a[1]||(a[1]=e=>u.ArrNum=e),style:{width:"240px"},onInput:u.fetchArrNum,onKeyup:[s(u.upValue,["up"]),s(u.downValue,["down"])],placeholder:"输入学号"},null,8,["modelValue","onInput","onKeyup"]),r("h2",null,"当前学生："+o(u.ArrName),1),d(w,{min:"0",required:"",modelValue:u.grades,"onUpdate:modelValue":a[2]||(a[2]=e=>u.grades=e),style:{width:"240px"},onKeyup:s(u.handleInput,["enter"]),placeholder:"输入成绩"},null,8,["modelValue","onKeyup"]),d(h,{onClick:u.handleInputToExpert},{default:t((()=>[i("导出")])),_:1},8,["onClick"]),r("div",I,[r("div",_,[r("div",b,[r("div",N,[(m(!0),l(g,null,c(u.nums,(e=>(m(),l("p",null,o(e),1)))),256))]),r("div",E,[(m(!0),l(g,null,c(u.names,(e=>(m(),l("p",null,o(e),1)))),256))]),r("div",j,[(m(!0),l(g,null,c(u.RawGrades,(e=>(m(),l("p",null,o(e),1)))),256))]),r("div",T,[(m(!0),l(g,null,c(u.avgEverySeven,((e,a)=>(m(),l("p",{key:a},o(e.toFixed(2)),1)))),128))])])])])])],64)}],["__scopeId","data-v-b0776dd0"]]);export{F as default};
